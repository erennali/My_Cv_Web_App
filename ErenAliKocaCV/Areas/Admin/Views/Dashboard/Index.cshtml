@{
    ViewData["Title"] = "Dashboard";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="page-title-box d-flex align-items-center justify-content-between mb-4">
                <h4 class="mb-0">Dashboard Overview</h4>
                <div class="page-title-right">
                    <div class="dropdown">
                        <button class="btn btn-sm btn-light dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="far fa-calendar-alt me-1"></i> <span id="selected-period">Last 30 Days</span>
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <li><a class="dropdown-item period-option" href="javascript:void(0);" data-period="7">Last 7 Days</a></li>
                            <li><a class="dropdown-item period-option" href="javascript:void(0);" data-period="30">Last 30 Days</a></li>
                            <li><a class="dropdown-item period-option" href="javascript:void(0);" data-period="90">Last 90 Days</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Welcome Card -->
    <div class="row">
        <div class="col-12">
            <div class="card mb-4">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="flex-grow-1">
                            <h5 class="fw-semibold">Welcome back, @User.Identity?.Name!</h5>
                            <p class="text-muted mb-0">Here's what's happening with your CV website today.</p>
                        </div>
                        <div>
                            <button class="btn btn-primary">
                                <i class="fas fa-sync-alt me-1"></i> Refresh Stats
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="row">
        <div class="col-xl-3 col-md-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="avatar-sm bg-primary-subtle rounded p-2 me-3">
                            <i class="fas fa-user fa-lg text-primary"></i>
                        </div>
                        <div class="flex-grow-1">
                            <p class="text-muted mb-1">Personal Info</p>
                            <h4 class="mb-0">@ViewBag.PersonalInfoCount</h4>
                        </div>
                        <div class="flex-shrink-0">
                            <span class="badge bg-soft-success text-success">
                                <i class="fas fa-check me-1"></i>Complete
                            </span>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a class="btn btn-sm btn-link ps-0" asp-area="Admin" asp-controller="PersonalInfo" asp-action="Index">
                            View Details <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        
        
        <div class="col-xl-3 col-md-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="avatar-sm bg-warning-subtle rounded p-2 me-3">
                            <i class="fas fa-briefcase fa-lg text-warning"></i>
                        </div>
                        <div class="flex-grow-1">
                            <p class="text-muted mb-1">Experience</p>
                            <h4 class="mb-0">@ViewBag.ExperienceCount</h4>
                        </div>
                        <div class="flex-shrink-0">
                            <span class="badge bg-soft-info text-info">
                                <i class="fas fa-info-circle me-1"></i>Active
                            </span>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a class="btn btn-sm btn-link ps-0" asp-area="Admin" asp-controller="Experience" asp-action="Index">
                            View Details <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-3 col-md-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <div class="avatar-sm bg-danger-subtle rounded p-2 me-3">
                            <i class="fas fa-code fa-lg text-danger"></i>
                        </div>
                        <div class="flex-grow-1">
                            <p class="text-muted mb-1">Skills</p>
                            <h4 class="mb-0">@ViewBag.SkillCount</h4>
                        </div>
                        <div class="flex-shrink-0">
                            <span class="badge bg-soft-info text-info">
                                <i class="fas fa-info-circle me-1"></i>Active
                            </span>
                        </div>
                    </div>
                    <div class="mt-3">
                        <a class="btn btn-sm btn-link ps-0" asp-area="Admin" asp-controller="Skill" asp-action="Index">
                            View Details <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Projects & Services Row -->
    <div class="row">
        <div class="col-xl-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-header bg-transparent border-bottom d-flex align-items-center justify-content-between">
                    <h5 class="mb-0">Projects</h5>
                    <a class="btn btn-sm btn-primary" asp-area="Admin" asp-controller="Project" asp-action="Index">
                        <i class="fas fa-plus me-1"></i> Add New
                    </a>
                </div>
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="avatar-sm bg-info-subtle rounded p-2 me-3">
                            <i class="fas fa-project-diagram fa-lg text-info"></i>
                        </div>
                        <div>
                            <h4 class="mb-0">@ViewBag.ProjectCount</h4>
                            <p class="text-muted mb-0">Total Projects</p>
                        </div>
                    </div>
                    
                    <div class="progress mb-4" style="height: 10px;">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 70%;" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    
                    <div class="text-center">
                        <a class="btn btn-sm btn-link" asp-area="Admin" asp-controller="Project" asp-action="Index">
                            View All Projects <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-header bg-transparent border-bottom d-flex align-items-center justify-content-between">
                    <h5 class="mb-0">Services</h5>
                    <a class="btn btn-sm btn-primary" asp-area="Admin" asp-controller="Service" asp-action="Index">
                        <i class="fas fa-plus me-1"></i> Add New
                    </a>
                </div>
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <div class="avatar-sm bg-secondary-subtle rounded p-2 me-3">
                            <i class="fas fa-cogs fa-lg text-secondary"></i>
                        </div>
                        <div>
                            <h4 class="mb-0">@ViewBag.ServiceCount</h4>
                            <p class="text-muted mb-0">Total Services</p>
                        </div>
                    </div>
                    
                    <div class="progress mb-4" style="height: 10px;">
                        <div class="progress-bar bg-secondary" role="progressbar" style="width: 85%;" aria-valuenow="85" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    
                    <div class="text-center">
                        <a class="btn btn-sm btn-link" asp-area="Admin" asp-controller="Service" asp-action="Index">
                            View All Services <i class="fas fa-arrow-right ms-1"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Recent Messages & Activity Log -->
    <div class="row">
        <div class="col-xl-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-header bg-transparent border-bottom">
                    <div class="d-flex align-items-center">
                        <h5 class="mb-0">Recent Messages</h5>
                        <span class="badge bg-soft-danger text-danger ms-2">@ViewBag.MessageCount New</span>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="px-3 py-2 bg-light border-bottom d-flex justify-content-between">
                        <span class="text-muted">From</span>
                        <span class="text-muted">Date</span>
                    </div>
                    <div class="message-list" style="max-height: 250px; overflow-y: auto;">
                        @if (ViewBag.Messages != null && ViewBag.Messages.Count > 0)
                        {
                            @foreach (var message in ViewBag.Messages)
                            {
                                <div class="d-flex align-items-center border-bottom p-3">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-1">@message.Name</h6>
                                        <p class="text-muted mb-0 small">@(message.Message.Length > 50 ? message.Message.Substring(0, 50) + "..." : message.Message)</p>
                                    </div>
                                    <div class="text-muted small">
                                        @message.CreatedAt.ToString("dd MMM")
                                    </div>
                                </div>
                            }
                        }
                        else
                        {
                            <div class="text-center p-4">
                                <i class="fas fa-inbox fa-2x text-muted mb-2"></i>
                                <p class="mb-0">No messages yet</p>
                            </div>
                        }
                    </div>
                    <div class="p-3 text-center">
                        <a class="btn btn-sm btn-primary" asp-area="Admin" asp-controller="Contact" asp-action="Messages">
                            View All Messages
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-xl-6">
            <div class="card mb-4 border-0 shadow-sm">
                <div class="card-header bg-transparent border-bottom">
                    <h5 class="mb-0">System Status</h5>
                </div>
                <div class="card-body">
                    <div class="row text-center">
                        <div class="col-4">
                            <div class="mb-2">
                                <i class="fas fa-file-alt fa-2x text-info"></i>
                            </div>
                            <h5 class="mb-1">@(ViewBag.PersonalInfoCount > 0 ? "Active" : "Inactive")</h5>
                            <p class="text-muted mb-0 small">CV Status</p>
                        </div>
                        <div class="col-4">
                            <div class="mb-2">
                                <i class="fas fa-server fa-2x text-success"></i>
                            </div>
                            <h5 class="mb-1">Online</h5>
                            <p class="text-muted mb-0 small">Server Status</p>
                        </div>
                        <div class="col-4">
                            <div class="mb-2">
                                <i class="fas fa-shield-alt fa-2x text-warning"></i>
                            </div>
                            <h5 class="mb-1">Secure</h5>
                            <p class="text-muted mb-0 small">Security Status</p>
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <h6 class="mb-3">CV Completion</h6>
                        <div class="progress mb-4" style="height: 10px;">
                            @{
                                int totalSections = 8; // Adjust based on your sections
                                int completedSections = 0;
                                
                                if (ViewBag.PersonalInfoCount > 0) completedSections++;
                                if (ViewBag.EducationCount > 0) completedSections++;
                                if (ViewBag.ExperienceCount > 0) completedSections++;
                                if (ViewBag.SkillCount > 0) completedSections++;
                                if (ViewBag.ProjectCount > 0) completedSections++;
                                if (ViewBag.ServiceCount > 0) completedSections++;
                                
                                int completionPercentage = (completedSections * 100) / totalSections;
                            }
                            <div class="progress-bar bg-primary" role="progressbar" style="width: @completionPercentage%;" aria-valuenow="@completionPercentage" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="text-center">
                            <span class="badge bg-primary">@completionPercentage%</span> completed
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Period selector functionality
            const periodOptions = document.querySelectorAll('.period-option');
            const selectedPeriodEl = document.getElementById('selected-period');
            
            periodOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const period = this.getAttribute('data-period');
                    selectedPeriodEl.textContent = `Last ${period} Days`;
                    // Here you would typically reload data based on the selected period
                });
            });
        });
    </script>
} 